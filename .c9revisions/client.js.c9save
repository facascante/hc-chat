{"ts":1362824136426,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1362829455269,"patch":[[{"diffs":[[1,"module.exports = {\n    \n    getRoom : function(client,gender,fn){\n        client.smembers('hc:rooms',function(err, rooms){\n            if(err){\n                fn(err);\n            }\n            else if(rooms.length > 0){\n                var i=0;\n                rooms.forEach(function(room){\n                    var roomInfo = JSON.stringify(room);\n                    if(roomInfo.visitor.length == 0){\n                        fn(null,roomInfo); return;\n                    }\n                    if(roomInfo.visitor.length == 1 &&  (roomInfo.visitor[0].gender != gender)){\n                        fn(null,roomInfo); return;\n                    }\n                    i++;\n                });\n                if(i == rooms.length){\n                    fn(null,{no:i++,visitor:[]});\n                }\n            }\n            else{\n                fn(null,{no:1,visitor:[]});\n            }\n        });\n    }\n}"]],"start1":0,"start2":0,"length1":0,"length2":908}]],"length":908,"saved":false}
{"ts":1362830710433,"patch":[[{"diffs":[[0,"        });\n"],[1,"    },\n    addVisitor : function(client,room,visitor,fn){\n        client.srem('hc:rooms',room);\n        room.visitor.push(visitor);\n        client.sadd(room);\n"],[0,"    }\n}"]],"start1":1100,"start2":1100,"length1":19,"length2":178}]],"length":1278,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362833971006,"patch":[[{"diffs":[[0,"gify(room);\n"],[1,"                    /*** is room empty ***/\n"],[0,"            "]],"start1":338,"start2":338,"length1":24,"length2":68},{"diffs":[[0,"              }\n"],[1,"                    /*** is room contain 1 visitor and gender is opposite ***/\n"],[0,"                "]],"start1":505,"start2":505,"length1":32,"length2":111},{"diffs":[[0,"        });\n"],[1,"                /*** no more vacant room ***/\n"],[0,"            "]],"start1":803,"start2":803,"length1":24,"length2":70},{"diffs":[[0,"}\n            }\n"],[1,"            /*** no room created yet ***/\n"],[0,"            else"]],"start1":966,"start2":966,"length1":32,"length2":74},{"diffs":[[0,",visitor"],[-1,",fn"],[0,""],[1,""],[0,"){\n     "]],"start1":1156,"start2":1156,"length1":19,"length2":16}]],"length":1275,"saved":false}
{"ts":1362834255565,"patch":[[{"diffs":[[0,"(client,"],[-1,"gend"],[1,"us"],[0,"er,fn){\n"]],"start1":46,"start2":46,"length1":20,"length2":18},{"diffs":[[0,"ength > 0){\n"],[1,"                var isExist = false;\n                rooms.forEach(function(room){\n                    room.visitor.forEach(function(visitor){\n                        if(visitor.username == user.username){\n                            isExist = true;\n                        }\n                    });\n                });\n"],[0,"            "]],"start1":208,"start2":208,"length1":24,"length2":344},{"diffs":[[0,"posite ***/\n"],[-1,""],[0,"            "]],"start1":906,"start2":906,"length1":24,"length2":24},{"diffs":[[0,"nder != "],[1,"user."],[0,"gender))"]],"start1":997,"start2":997,"length1":16,"length2":21}]],"length":1598,"saved":false}
