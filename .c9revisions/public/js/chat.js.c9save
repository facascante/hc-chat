{"ts":1362857857632,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"$(function() {\n\n  var socket = io.connect();\n\n  socket.on('error', function (reason){\n    console.error('Unable to connect Socket.IO', reason);\n  });\n\n  socket.on('connect', function (){\n    console.info('successfully established a working connection');\n  });\n  \n  socket.on('participants complete', function (data){\n\t    alert(JSON.stringify(data));\n  });\n\n  socket.on('new msg', function(data) {\n\t  var photo_url = \"\";\n\t  if(data.provider == 'facebook'){\n\t\t  photo_url = 'http://graph.facebook.com/' + data.nickname + '/picture';\n\t  }\n\t  else{\n\t\t  photo_url = 'http://graph.facebook.com/' + data.nickname + '/picture';\n\t  }\n\t  if(data.gender == \"male\"){\n\t\t  $(\" .messagewindow \").append(\"<img class='leftp' src='\"+photo_url+\"'></img><p class='me-chat'>\" + data.msg + \"</p>\");\n\t  }\n\t  else{\n\t\t  $(\" .messagewindow \").append(\"<img class='rightp' src='\"+photo_url+\"'></img><p class='you-chat'>\" + data.msg + \"</p>\");\n\t  }\n  });\n\n  socket.on('user leave', function(data) {\n  });\n\n  $(\"#reply\").click(function(){\n\n\t  var inputText = $(\"#message\").val().trim();\n\t    if(inputText) {\n\t      var chunks = inputText.match(/.{1,1024}/g)\n\t        , len = chunks.length;\n\n\t      for(var i = 0; i<len; i++) {\n\t        socket.emit('my msg', {\n\t          msg: chunks[i]\n\t        });\n\t      }\n\n\t      $(this).val('');\n\n\t      return false;\n\t    }\n  });\n  $(\"#message\").keypress(function(e) {\n    var inputText = $(this).val().trim();\n    if(e.which == 13 && inputText) {\n      var chunks = inputText.match(/.{1,1024}/g)\n        , len = chunks.length;\n\n      for(var i = 0; i<len; i++) {\n        socket.emit('my msg', {\n          msg: chunks[i]\n        });\n      }\n\n      $(this).val('');\n\n      return false;\n    }\n  });\n\n\n});\n\n\n"]],"start1":0,"start2":0,"length1":0,"length2":1715}]],"length":1715}
